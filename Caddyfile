{
  auto_https off
  admin off
}
:80 {
  @www header_regexp www Host ^www\.(.*)$
  @acceptwebp header Accept *image/webp*
  @acceptavif header Accept *image/avif*
  @static path *.css *.js *.ico *.gif *.jpg *.jpeg *.png *.svg *.woff *.webp
  redir @www {scheme}://{re.www.1} 301
  route @static {
    header Cache-Control "public, max-age=31557600, must-revalidate"
  }
  route @acceptavif {
    try_files {path}.avif
  }

  route @acceptwebp {
    try_files {path}.webp
  }
  encode zstd gzip
  root * /html
  file_server {
    precompressed br gzip
  }
  handle_errors {
    rewrite * /{http.error.status_code}.html
    file_server {
      precompressed br gzip
    }
  }
}
